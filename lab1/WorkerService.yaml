openapi: 3.0.1
info:
  title: Workers service REST endpoints
  description: COA lab1 Вариант 13104
  version: 1.0.0
servers:
  - url: https://localhost:78788/api/v1
tags:
  - name: worker
    description: Worker management(only one worker every time)
  - name: workers
    description: Workers management
paths:
  /company/worker/{id}:
    get:
      tags:
        - worker
      summary: get worker by id
      operationId: getWorkerById
      parameters:
        - name: id
          in: path
          required: true
          description: Worker id to find
          schema:
            type: integer
            format: int64
            nullable: false
            minimum: 0
            exclusiveMinimum: true
            example: 1
      responses:
        "200":
          description: Returns worker by id
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/WorkerFullInfo"
        "404":
          description: Invalid worker not found
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 404
                  message:
                    type: string
                    example: Invalid worker not found
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"
    delete:
      tags:
        - worker
      summary: delete worker by id
      operationId: deleteWorkerById
      parameters:
        - name: id
          in: path
          required: true
          description: Coordinate id to find
          schema:
            type: integer
            format: int64
            nullable: false
            minimum: 0
            exclusiveMinimum: true
            example: 1
      responses:
        "204":
          description: The worker was successfully deleted
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 204
                  message:
                    type: string
                    example: The worker was successfully deleted
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "404":
          description: Worker not found
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 404
                  message:
                    type: string
                    example: Worker not found
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"
  /company/worker:
    post:
      tags:
        - worker
      summary: Create a new worker in company
      operationId: createWorker
      requestBody:
        content:
          application/xml:
            schema:
              $ref: "#/components/schemas/CreateWorkerRequest"
      responses:
        "200":
          description: Created successfully
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/WorkerFullInfo"
        "400":
          description: input invalid
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 400
                  message:
                    type: string
                    example: invalid input
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"
    put:
      tags:
        - worker
      summary: update worker by id
      operationId: updateWorkerById
      requestBody:
        content:
          application/xml:
            schema:
              $ref: "#/components/schemas/WorkerFullInfo"
      responses:
        "200":
          description: updated worker
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/WorkerFullInfo"
        "404":
          description: worker not found
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 404
                  message:
                    type: string
                    example: worker not found
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"
  /company/worker/maxSalary:
    get:
      tags:
        - worker
      summary: get worker, whose salary is the highest
      operationId: getWorkerWithHighestSalary
      responses:
        "200":
          description: worker w highest salary 
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/WorkerFullInfo"
        "400":
          description: worker not found
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 400
                  message:
                    type: string
                    example: worker not found
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"

  /company/workers:
    get:
      tags:
        - workers
      summary: Returns all workers in sort
      operationId: getWorkers
      parameters:
        - name: sortElements
          in: query
          required: false
          description: sort should be done by any combination of all fields in object. It means that in request should have an array where we save all fields, by which sorted result.
          explode: true
          schema:
            type: array
            items:
              type: string
              default: id
              enum:
                - id
                - name
                - creationDate
                - coordinates.x
                - coordinates.y
                - salary
                - creationDate
                - startDate
                - endDate
                - position
                - organization.name
                - organization.annualTurnover
        - name: isUpper
          in: query
          required: false
          description: The order of result.
          schema:
            type: boolean
            default: true
        - name: filter
          in: query
          required: false
          description: Array of fields used for filtering.
          schema:
            type: array
            example: id[eq]=2
            items:
              type: string
              pattern: '^(id|creationDate|coordinates\.x|coordinates\.y|salary|startDate|endDate|position|view|organization\.annualTurnover|organization.\fullName)\[(eq|ne|gt|lt|lte|gte)\]=.+$'
        - name: pageSize
          in: query
          required: false
          description: page size for pagination
          schema:
            type: integer
            format: int32
            nullable: false
            minimum: 1
            default: 1
            exclusiveMinimum: false
            example: 1
        - name: page
          in: query
          required: false
          description: page number to be paginated
          schema:
            type: integer
            format: int32
            nullable: false
            default: 0
            minimum: 0
            exclusiveMinimum: false
            example: 0
      responses:
        "200":
          description: Returned all workers by requirements
          content:
            application/xml:
              schema:
                $ref: "#/components/schemas/SortedWorkersResponse"
        "400":
          description: invalid input
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 400
                  message:
                    type: string
                    example: invalid input
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        "500":
          description: Server not accessied now
          content:
            application/xml:
              schema:
                xml:
                  name: Error
                type: object
                properties:
                  code:
                    type: integer
                    format: int32
                    example: 500
                  message:
                    type: string
                    example: Internal server error
                  time:
                    type: string
                    format: date-time
                    example: 2023-10-13T00:00:00Z
        default:
          description: Returns error code, error message and time
          content:
              application/xml:
                schema:
                  $ref: "#/components/schemas/Error"
  /company/workers/getAmountByEndDate:
    get:
      tags:
        - workers
      summary: Returns number of all workers, whose end date equals or later than given(by our choices)
      operationId: getWorkersByEndDate
      parameters:
        - name: "endDate"
          in: query
          description: end date
          required: true
          schema:
            type: string
            format: date
            example: "2022-12-31"
            nullable: false
        - name: "condition"
          in: query
          description: greater or equals
          required: true
          schema:
            type: string
            enum:
              - greater
              - equals
            nullable: false
      responses:
        "200":
          description: successfully get the number of workers, who satisfies the condition
          content:
            application/xml:
              schema:
                type: object
                properties:
                  number:
                    type: integer
                    example: 256
                xml:
                  name: numberOfWorkers
        "400":
          description: wrong date format or wrong condition chosen
        "500":
          description: server not available

components:
  schemas:
    Coordinates:
      type: object
      properties:
        x:
          type: integer
          format: int32
          nullable: false
          example: 12
        y:
          type: number
          format: double
          minimum: -561
          exclusiveMinimum: true
          nullable: false
          example: -560
    Organization:
      type: object
      properties:
        id:
          type: integer
          nullable: false
          minimum: 0
          exclusiveMinimum: true
          example: 121
        fullName:
          type: string
          nullable: false
          maxLength: 758
          example: "Google"
        annualTurnover:
          type: integer
          nullable: false
          minimum: 0
          exclusiveMinimum: true
          example: 654000000
    WorkerFullInfo:
      xml:
        name: "WorkerFullInfo"
      type: object
      properties:
        id:
          type: integer
          format: int64
          minimum: 1
          exclusiveMinimum: false
          description: Unique identifier of worker. be generated automatically
          example: 1
        name:
          type: string
          nullable: false
          minLength: 1
          example: "liao"
        Coordinates:
          $ref: "#/components/schemas/Coordinates"
        creationDate:
          type: string
          format: date-time
          nullable: false
          description: Be generated automatically
          example: "2023-09-10T00:00:00Z"
        salary:
          type: number
          format: float
          nullable: false
          minimum: 0
          exclusiveMinimum: true
          example: 23333
        startDate:
          type: string
          format: date
          nullable: false
          example: "2022-09-19"
        endDate:
          type: string
          format: date
          nullable: false
          example: "2022-12-31"
        position:
          type: string
          enum:
            - MANAGER
            - HUMAN_RESOURCES
            - HEAD_OF_DEPARTMENT
            - DEVELOPER
            - COOK
          nullable: false
          example: "MANAGER"
        Organization:
          $ref: "#/components/schemas/Organization"
    CreateWorkerRequest:
      type: object
      properties:
        name:
          type: string
          nullable: false
          minLength: 1
          example: "liao"
        coordinates:
          $ref: "#/components/schemas/Coordinates"
        salary:
          type: number
          format: float
          nullable: false
          minimum: 0
          exclusiveMinimum: true
          example: 23333
        startDate:
          type: string
          format: date
          nullable: false
          example: "2022-09-19"
        endDate:
          type: string
          format: date
          nullable: false
          example: "2022-12-31"
        position:
          type: string
          enum:
            - MANAGER
            - HUMAN_RESOURCES
            - HEAD_OF_DEPARTMENT
            - DEVELOPER
            - COOK
          nullable: false
          example: "MANAGER"
        organization:
          $ref: "#/components/schemas/Organization"
    SortedWorkersResponse:
      type: object
      properties:
        pagenumber:
          type: integer
          description: Номер текущей страницы
          format: int32
        numberOfElements:
          type: integer
          description: Количество элементов на текущей странице
          format: int32
        first:
          type: boolean
          description: Является ли данная страница первой
        last:
          type: boolean
          description: Является ли данная страница последней
        hasNext:
          type: boolean
          description: Имеется ли следующая страница
        hasPrevious:
          type: boolean
          description: Имеется ли предыдущая страница
        totalPages:
          type: integer
          description: Количество страниц
          format: int32
        totalElements:
          type: integer
          description: Общее количество элементов
          format: int64
        hasContent:
          type: boolean
          description: Имеется ли содержимое
        content:
          type: array
          xml:
            name: content
            wrapped: true
          description: Содержимое в виде списка элементов
          items:
            $ref: "#/components/schemas/WorkerFullInfo"
    Error:
      xml:
        name: Error
      type: object
      required:
        - httpCode
        - message
        - time
      properties:
        code:
          type: integer
          format: int32
          example: 404
        message:
          type: string
          example: Not Found
        time:
          type: string
          format: date-time
          example: 2023-10-13T00:00:00Z